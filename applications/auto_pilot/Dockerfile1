FROM ubuntu:bionic
RUN apt-get update
RUN apt-get install python3 python3-pip -y
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple scipy
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple pillow
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple numpy

RUN pip3 install grpcio
RUN pip3 install protobuf

ADD auto_pilot/1_Frame_Feeder/app /container/

ADD grpc/app/container_entry.sh /container/
ADD grpc/app/server.py /container/
ADD grpc/app/model_pb2_grpc.py /container/
ADD grpc/app/model_pb2.py /container/
ADD grpc/app/proxy_pb2_grpc.py /container/
ADD grpc/app/proxy_pb2.py /container/

CMD ["python3", "/container/server.py", "1", "8000"]

EXPOSE 8000