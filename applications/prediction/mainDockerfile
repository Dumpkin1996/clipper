FROM ubuntu:bionic
RUN apt-get update
RUN apt-get install python3 python3-pip -y

# docker build -f ./prediction/mainDockerfile -t prediction:main .
# docker run --runtime=nvidia -p 10000:10000 -it prediction:main
# docker run --runtime=nvidia -d -p 10000:10000 -it prediction:main

# for c1
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple pandas quandl grpcio protobuf 
ADD prediction/c1_Stock_Price_Retriever /container/c1_Stock_Price_Retriever

# for c2
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple numpy tweepy
ADD prediction/c2_Twitter_Collector /container/c2_Twitter_Collector

# for c3
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple spacy
RUN python3 -m spacy download en_core_web_sm
ADD prediction/c3_Tokenizer /container/c3_Tokenizer

# for c4
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple nltk
RUN python3 -m spacy download en
ADD prediction/c4_Sentiment_Analysis /container/c4_Sentiment_Analysis

# for c5
RUN apt-get install python3-all-dev build-essential swig git libpulse-dev libasound2-dev -y
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple sklearn keras tensorflow
ADD prediction/c5_LSTM_Predictor /container/c5_LSTM_Predictor

# for c6
ADD prediction/c6_Mem /container/c6_Mem

# for c8
RUN pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple fastai
ADD prediction/c8_KNN /container/c8_KNN

# for c9
ADD prediction/c9_RandomForest /container/c9_RandomForest

# for c10
ADD prediction/c10_Regression /container/c10_Regression

# for c11
ADD prediction/c11_Conclusion /container/c11_Conclusion

# for main.py
ADD prediction/main.py /container

RUN ls /container

CMD ["python3","/container/main.py"]

EXPOSE 10000
